# 第5章 软件构建中的设计 / Design in Construction

## 5.1 设计中的挑战 / Design Challenges

### 设计是一个险恶的问题 / Design Is a Wicked Problem

险恶的问题就是那种只有通过解决或部分解决才能被明确的问题。这个看似矛盾的定义其实是在暗示
说，你必须首先把这个问题“解决”一遍以便能够明确地定义它，然后再次解决该问题，从而形成一个
可行的方案。

### 设计是个了无章法的过程 / Design Is a Sloppy Process

软件设计的成功应该是组织良好、干净利落的，然而形成这个设计的过程却并非如此清爽。

说设计了无章法，是因为在此过程中你会采取很多错误的步骤，多次误入歧途——你会犯很多的错误。
事实上，犯错正是设计的关键所在——在设计阶段犯错并加以改正，其代价要比在编码后才发现同样的
错误并彻底修改低得多。

### 设计是自然而然形成的 / Design Is Emergent

把设计的这些特征综合归纳起来，我们可以说设计是“自然而然形成的”。设计不是在谁的头脑中直接
跳出来的。它是在不断的设计评估、非正式讨论、写试验代码以及修改试验代码中演化和完善的。

## 5.2 关键的设计概念 / Key Design Concepts

### 软件的首要技术使命：管理复杂度 / Software's Primary Techinical Imperative: Managing Complexity

Brooks认为，两类不同的问题导致软件开发变得困难——本质的问题和偶然的问题。本质的属性是一件
事物必须具备、如果不具备就不再是该事物的属性。偶然的属性则是指一件事物碰巧具有的属性，有
没有这些属性都并不影响这件事物本身。

Brooks观察到，软件开发中大部分的偶然性难题在很久以前就已得到解决了，在软件开发剩下的那些
本质性困难上的进展将会变得相对缓慢。究其原因，是因为从本质上说软件开发就是不断地去发掘错
综复杂、相互连接的整套概念的所有细节。其本质性的困难来自很多方面：必须去面对复杂、无序的
现实世界；精确而完整地识别出各种依赖关系与例外情况；设计出完全正确而不是大致正确的解决方
案；诸如此类。

## 5.3 设计构造块：启发式方法 / Design Building Blocks: Heuristics

### 当继承能简化设计时就继承 / Inherit-When Inheritance Simplifies the Design

编程语言如果能支持像Open()或Close()这样在运行期间才能确定所针对的对象的实际类型的操作，
这种能力叫做“多态/polymorphism”。

继承是面向对象编程中最强大的工具之一。如果使用得当，它能带来极大的益处，然而如果使用不当，
它也有极大的弊端。

### 隐藏秘密（信息隐藏）/ Hide Secrets (Information Hiding)

信息隐藏是结构化程序设计与面向对象设计的基础之一。结构化设计里面的“黑盒子”概念就是来源于
信息隐藏。在面向对象设计中，它又引出了封装和模块化的概念，并与抽象的概念紧密相关。

信息隐藏是减少重复工作的强大技术。它在不断增长的、大量变化的环境中尤其有用。

设计类的接口与设计其他环节一样，都是一个迭代的过程。如果你第一次没有得到合适的接口，那么
就多试几次，直到设计稳定下来。如果设计仍不稳定，拿你就需要换种方法再尝试。

### 查阅常用的设计模式 / Look for Common Design Patterns

设计模式精炼了众多现成的解决方案，可用于解决很多软件开发中最常见的问题。有些软件问题要求
全新的解决方案，但是大多数问题都和过去遇到过的问题类似，因此可以使用类似的解决方案加以解
决。

### 使用启发式方法的原则 / Guidelines for Using Heuristics

软件中的设计方法可以从其他领域中的设计方法借鉴许多东西。最早有关解决问题的探索方法的著作
之一便是G·波利亚写的《怎样解题》。

最有效的原则之一就是不要卡在单一的方法上。如果用UML画设计图不可行，那么就直接用英语来写。
写段简短的测试程序。尝试一种截然不同的方法。想出一种蛮力解决方案。用铅笔画出轮廓和草图来
指导思想。如果这些方法都不行，那么就先离开这个问题。可以去散散步，或者去想一想其他的事情，
然后再回来重新面对这个问题。如果你尽了全力还没能取得突破，那么暂时不要去想它反而会比穷思
苦想的效果要好。

你无须马上解决整个设计难题。一旦被卡住了，那么请记住回过头来时有一处地方需要做决策，但眼
下你还没有足够的信息来解决这个问题。你可以让那些问题留在未解决状态，等到你拥有更多信息之
后再去做。

## 5.4 设计实践 / Design Practices

当你首次尝试得出了一个看上去足够好的设计方案后，请不要停下来！第二个尝试几乎肯定会好于第
一个，而你也会从每次尝试中都有所收获，这有助于改善整体设计。在经历了1000次研究灯丝材料的
失败以后，有人问爱迪生，因为他什么也没有发现，会不会感到时间全都浪费了。“当然不会”，爱迪
生大概是这样回答的：“因为我已经发现了 1000种材料是不能用的。”在大多数情况下，用一种方法
来解决问题会为你带来一些新的洞察力，从而帮助你使用另一种更好的方法来解决问题。

## 5.5 对流行的设计方法的评论 / Comments on Popular Methodologies

那么你怎样才能判断出需要多少设计才够呢？这是一个主观判断，没有人能完美地回答它。不过，在
你没有足够的信心去判断最佳设计量的时候，请记住有两种情况一定是不对的：设计所有的细节和不
做任何设计。这两个位于立场两端的极端主义者所倡导的做法，恰恰被证明是仅有的两个永远是错误
的想法。
