## 第31章 布局与风格

本章转向计算机编程的美学话题——程序源代码的布局。编排出色的代码会带来视觉上和思维上的愉悦，这是非程序员的人不能感受到的。而精雕细琢代码、使之达到美观的程序员们，却会从这一过程得到艺术上的满足。

### 31.1 基本原则

编程工作量的一小部分是写让机器读的程序，大部分工作是写能让他人看懂的程序。所以，好的布局应该这样做：

- 准确地表现代码的逻辑结构
- 始终如一地表现代码的逻辑结构
- 改善可读性
- 经得起修改

### 31.2 布局技术

通过不多的集中布局手段就能实现良好的布局。

1）空白

空白能够增强可读性。空白包括空格、制表符、换行、空行，是展现程序结构的主要手段。

2）括号

括号应该用得比你觉得需要的更多。对包含两个以上的项的表达式，应该用括号去澄清之。

### 31.3 布局风格

1）纯块结构

2）模仿纯块结构

3）使用begin-end对（花括号）指定块边界

4）行尾布局

所有风格都不绝对可靠，都偶尔需要进行“合理而明显”的折中。出于美观原因你可能会更喜欢这种或那种。

### 31.4 控制结构的布局

- 不要用未缩进的begin-end对
- 别让begin和end两次缩进
- 段落之间要使用空行
- 单语句代码块的格式要前后统一
- 对于复杂表达式，将条件分隔放在几行上
- 不用goto
- case语句不要有行尾布局的例外

### 31.5 单条语句的布局

1）语句长度

一条常见但有点过时的规则，就是语句长度应限制在80隔字符以内。

2）用空格使语句显得清楚

- 使用空格会让逻辑表达式更易读
- 使用空格让数组引用更容易读
- 使用空格让子程序参数更容易读

3）格式化后续行

4）每行仅写一条语句

5）数据声明的布局

- 每行只声明一个数据
- 变量声明应尽量接近其首次使用的位置
- 合理组织声明顺序
- C++中，声明指针变量时请把星号（*）靠近变量名，或者去声明指针类型

### 31.6 注释的布局

注释做得好可大大增进程序的可读性，而糟糕的注释却会帮倒忙。

- 注释的缩进要与相应代码一致
- 每行注释用至少一个空行分开

### 31.7 子程序的布局

- 用空行分隔子程序的各部分
- 将子程序参数按标准缩进

### 31.8 类的布局

1）类接口的布局

在布局类接口时，一般将类成员按如下顺序表示：

- 说明类及其完整用法的头部注释
- 构造函数与析构函数
- public子程序
- protected子程序
- private子程序和数据成员

2）类实现的布局

类实现通常按如下顺序排布：

- 描述类所在文件内容的头部注释
- 类数据
- public子程序
- protected子程序
- private子程序

3）文件和程序布局

- 一个文件应只有一个类
- 文件的命名应与类名有关
- 在文件中清晰地分隔各子程序：至少用两个空格
- 按字母顺序排列子程序
