## 第21章 协同构建

所有的协同构建技术都试图通过这样或那样的途径，将展示你工作的过程正式化，以便把错误暴露出来。

### 21.1 协同开发实践概要

“协同构建”包括结对编程、正式检查、非正式技术复查、文档阅读，以及其他让开发人员共同承担创建代码及其他工作产品责任的技术。各种协同构建技术之间尽管存在一些差异，但它们都基于一个相同的思想，那就是在工作中开发人员总会对某些错误点视而不见，而其他人不会有相同的盲点，所以开发人员让其他人来检查自己的工作是很有好处的。

协同构建的首要目的就是改善软件的质量。软件测试在单独运用的时候效果比较有限，单元测试的平均缺陷检出率只有大约30%，集成测试大约35%，小规模beta测试是35%。与此相反，对设计和代码进行详细检查的平均效能为55%和60%（Jones 1996）。协同构建的另一个好处是，它可以缩短开发周期，从而降低开发成本。

各种不同的研究表明，协同开发不但在捕获错误方面比测试的效能更高，所能发现的错误类型也不同于测试（Myers 1978; Basili, Selby and Hutchens 1986）。

刚出道的编程人员需要那些有更丰富知识的前辈给予指导，而资深程序员们往往太忙而没时间同他人分享他们的知识。复查为这两种人提供了一个技术交流的平台，所以，无论在未来还是现在，复查都是培养新人以提高其代码质量的好机会。

### 21.2 结对编程

在进行结对编程的时候，一位程序员敲代码，另外一位注意有没有出现错误，并考虑某些策略性的问题，例如代码的编写是否正确，正在编写的代码是否所需等。虽然结对编程的概念很简单，但是从中获益就需要遵守几条准则。结对编程有许多好处：

- 与单独开发相比，结对编程能够使人们在压力之下保持更好的状态。
- 能够改善代码质量。
- 能缩短进度时间表。
- 还具有协同构建的其他常见好处，包括传播公司文化，指导初级程序员以及培养集体归属感。

### 21.3 正式检查

详查（正式检查）是一种特殊的复查，种种迹象表明它在侦测缺陷方面特别有效，并且相对测试来说更加经济合理。独立的详查通常能够捕捉到60%的缺陷，设计和代码的联合详查通常能够去除产品中70%到85%，甚至是更多的缺陷（Jones 1996）。

相差的一个关键特征就是每个人都要扮演一个明确的角色，如主持人、作者、评论员、记录员、经理。无论任何情况下，详查的结果都不应当作为员工表现的评估标准。一般来说，参与详查的人数不应少于三人，少于三个人就不可能有单独的主持人、作者和评论员了，因为这三种角色不应当被合并。传统的建议是限制参与详查的人数在六人左右，因为如果人数过多，那么这个小组就变得难以管理。研究人员发现，通常情况下再增加两三个评论员并不会增加发现缺陷的数量。


### 21.4 其他类型的协同开发实践

1）走查

三三两两小聚，即为走查。聪明的、有纪律地进行走查，可以得到与正式检查类似的结果，即通常可以找到程序中20%到40%的错误。但一般而言，人们发现走查远没有详查来得有效。

2）代码阅读

代码阅读是详查和走查的另一种替代方案。在代码阅读中，你直接阅读源代码并从中找出错误。同时你也从质量的角度对代码做出评价，例如代码的设计、风格、可读性、可维护性以及效率等。

代码阅读与详查、走查之间的区别，就在于代码阅读更多地关注对代码进行的独立复查，而不是关注会议本身。其结果是每一个评论员的时间更多地花费在从代码中找出错误上面，而将较少的时间花费在会议上。

3）公开演示

公开演示是向客户展示软件产品的另一种复查形式，不要指望公开演示能成为提高产品技术质量的灵丹妙药。为展示做准备可能会对技术质量带来间接的正面影响，但通常更多的准备时间用于制作漂亮的演讲幻灯片，而不是改善软件品质。要改善技术品质应当依靠详查、走查或代码阅读。
