## 第12章 基本数据类型

基本数据类型是构建其他所有数据类型的构造块。本章涵盖了与基本数据类型有关的问题的基本处理方法。

### 12.1 数值概论

下面是一些避免在使用数的时候少犯错误的建议。

- 避免使用神秘数值（magic number）。它们是没有经过解释的数值文字量（litertal numbers）。它们的缺点是使得修改变得不容易、阅读不可读。一条很好的经验法则是程序主体中仅能出现的文字量就是0和1，任何其他文字量都应该换成更有描述性的表示。
- 预防除零错误。每次使用除号的时候都要考虑表达式的分母是否有可能为0。
- 使类型转换变得明显。确认当不同数据类型之间的转换发生时，阅读代码的人会注意到这点。
- 避免混合类型的比较。杰出的程序员会修改他们的代码来消除所有的编译器警告，通过警告来发现问题要比你自己赵容易得多。

### 12.2 整数

在用整数的时候需要注意检查整数的除法、整数溢出。

### 12.3 浮点数

使用浮点数主要考虑的是它的不精确性。主要包括避免数量级相差巨大的数之间的加减运算，避免等量判断而是改用替代方案，处理舍入误差问题。

由于舍入误差导致的错误与数字之间数量级相差太大的错误并无二致，解决的技术也相同。如下是专门用于解决舍入问题的常见方案：

- 换用一种精度更高的变量类型。
- 换用二进制编码的十进制（binary coded decimal, BCD）。BCD模式的处理更慢一些，也要占用更多的存储空间，但能防止很多舍入错误的发生。
- 把浮点变量变成整形变量。这是一种自力更生转到BCD变量的方法，将小数运算扩展为整数运算，无论从速度还是精度都是一种有效的解决方案，可以创建隐藏整数表示并支持数字运算的DollarsAndCents类。

### 12.4 字符和字符串

应当避免在所有的编程语言中使用字面形式表示的字符或者字符串，如果编程语言支持具名常量，就用具名常量加以取代，否则就用全局变量。这里面的原因很多，包括修改的便捷性，字面表示的含糊性等。

### 12.5 布尔变量

常有这样的情况，在需要编写一段复杂的判断时，你要尝试好几次才成功，而这种复杂的判断会给读者带来很重的思维负担。此时，可以使用布尔变量来简化这种判断，即用新的布尔变量来拆分原来复杂的判断条件。

C++、Java和VB里面含有预定义的布尔类型，C语言中没有，因此你需要定义自己的布尔类型。

### 12.6 枚举类型

枚举类型是一种允许用英语来描述某一类对象中每一个成员的数据类型。每当你看到字面形式数字的时候就应该问问自己，把它换成枚举类型是不是更合理。枚举类型特别适用于定义子程序参数。

在定义枚举类型的时候，可以单独定义出第一项（保留为非法值）和最后一项，便于循环边界，但需要在项目的编码标准中确定好第一个和最后一个元素的使用规则。

### 12.7 具名常量

具名常量很像变量，一旦赋值后就不能再修改了，它允许用一个名字而不是数字来表示固定的量。使用具名常量是一种将程序“参数化”的方法——把程序中可能变化的一个方面写为一个参数，当需要对其修改时修改一处就可以了。这种“单点控制（single-point control）”堆让软件真正地软了许多——用起来和改起来都很方便。

### 12.8 数组

数组是最简单和最常用的结构化数据类型，一个数组中含有一组类型完全相同，并且可以用数组下标来直接访问的条目。在使用数组时要确认所有的数组下标都没有超出数组的边界。计算机科学界的一些最聪明的人士建议永远不要随机地访问数组，而是建议使用集合、栈和队列等按顺序存取元素的数据结构来取代数组。

### 12.9 创建你自己的类型（类型别名）

程序员自定义的数据类型是语言所能赋予你的一种最强有力的、最有助于澄清你对程序的理解的功能之一。它保护你的程序免受预料之外更改之困扰，并使得程序更容易阅读。
