## 第18章 表驱动法

表驱动法是一种编程模式（scheme）——从表里面查找信息而不使用逻辑语句（if和case）。事实上，凡是能通过逻辑语句来选择的事物，都可以通过查表来选择。对简单的情况而言，使用逻辑语句更容易和直白。但随着逻辑链的越来越复杂，查表法也就愈发显得更具吸引力。

### 18.1 表驱动法使用总则

在使用表驱动法的时候，必须要解决两个问题。首先，你必须要回答怎样从表中查询条目的问题。你可以用一些数据来直接访问表，对于很难直接用于查表的数据需要采用更复杂的方法，如直接访问、索引访问和阶梯访问。

其次，你应该在表里面存些什么。如果表查询出来的结果是数据那么可以把这些数据保存到表里面。在另外一些情况下，表查询出来的结果是动作，那么可以保存描述该动作的代码或者实现该动作的子程序的引用。

### 18.2 直接访问表

直接访问表是无须绕很多复杂的圈子就能够在表里找到想要的信息，你当然希望总是能直接得到访问表的键值，因为这样既简单又快速。但有时候数据不是那么合作，此时就引出了构造查询表键值的问题。

- 复制信息从而能够直接使用键值
- 转换键值以使其能够直接使用
- 把键值转换提取成独立的子程序

### 18.3 索引访问表

使用索引的时候会先用一个基本类型的数据从一张索引表中查出一个键值，然后再用这一键值查出你感兴趣的主数据。索引访问技术有两个主要优点：

- 首先，如果主查询表中的每条记录都很大，那么创建一个浪费了很多空间的索引数组所用的空间要比创建一个浪费了很多空间的主查询表所用的空间小得多。
- 其次，即使你用了索引后没有节省内存空间，操作位于索引中的记录有时也要比操作位于主表中的记录更方便。

除此之外，索引访问技术在可维护性上具有的普遍优点：编写到表里面的数据比嵌入代码中的数据更容易维护。

### 18.4 阶梯访问表

阶梯结构的基本想法是，表中的记录对于不同的数据范围有效，而不是对不同的数据点有效。
